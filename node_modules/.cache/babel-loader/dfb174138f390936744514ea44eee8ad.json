{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createInterceptor = void 0;\n\nvar strict_event_emitter_1 = require(\"strict-event-emitter\");\n\nfunction createInterceptor(options) {\n  var observer = new strict_event_emitter_1.StrictEventEmitter();\n  var cleanupFns = [];\n  return {\n    apply: function () {\n      cleanupFns = options.modules.map(function (interceptor) {\n        return interceptor(observer, options.resolver);\n      });\n    },\n    on: function (event, listener) {\n      observer.addListener(event, listener);\n    },\n    restore: function () {\n      observer.removeAllListeners();\n\n      if (cleanupFns.length === 0) {\n        throw new Error(\"Failed to restore patched modules: no patches found. Did you forget to run \\\".apply()\\\"?\");\n      }\n\n      cleanupFns.forEach(function (restore) {\n        return restore();\n      });\n    }\n  };\n}\n\nexports.createInterceptor = createInterceptor;","map":{"version":3,"mappings":";;;;;;;AAEA;;AAgEA,SAAgBA,iBAAhB,CAAkCC,OAAlC,EAA6D;AAC3D,MAAMC,QAAQ,GAAG,IAAIC,yCAAJ,EAAjB;AACA,MAAIC,UAAU,GAA2B,EAAzC;AAEA,SAAO;AACLC,SAAK;AACHD,gBAAU,GAAGH,OAAO,CAACK,OAAR,CAAgBC,GAAhB,CAAoB,UAACC,WAAD,EAAY;AAC3C,eAAOA,WAAW,CAACN,QAAD,EAAWD,OAAO,CAACQ,QAAnB,CAAlB;AACD,OAFY,CAAb;AAGD,KALI;AAMLC,MAAE,YAACC,KAAD,EAAQC,QAAR,EAAgB;AAChBV,cAAQ,CAACW,WAAT,CAAqBF,KAArB,EAA4BC,QAA5B;AACD,KARI;AASLE,WAAO;AACLZ,cAAQ,CAACa,kBAAT;;AAEA,UAAIX,UAAU,CAACY,MAAX,KAAsB,CAA1B,EAA6B;AAC3B,cAAM,IAAIC,KAAJ,CACJ,0FADI,CAAN;AAGD;;AAEDb,gBAAU,CAACc,OAAX,CAAmB,UAACJ,OAAD,EAAQ;AAAK,sBAAO,EAAP;AAAS,OAAzC;AACD;AAnBI,GAAP;AAqBD;;AAzBDK","names":["createInterceptor","options","observer","strict_event_emitter_1","cleanupFns","apply","modules","map","interceptor","resolver","on","event","listener","addListener","restore","removeAllListeners","length","Error","forEach","exports"],"sources":["../src/createInterceptor.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}